<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HTMLDemo</title>
    <script src="Calender.js" type="text/javascript"></script>
    <script>
    window.onload = function(){
        
        var a = [
            '2017/03/04','2017/03/25','2017/04/09','2017/10/01',
            '2017/03/05','2017/03/26','2017/04/15','2017/10/02',
            '2017/03/11','2017/04/11','2017/04/16','2017/05/01',
            '2017/03/12','2017/04/01','2017/04/22','2017/08/15',
            '2017/03/18','2017/04/08','2017/04/23','2017/09/01',
            '2017/03/19','2017/04/02','2017/04/29','2017/02/02'
        ]
        
        ZxCalender.forDiv("MyCalender",2017,a);
    }
    
    </script>
    <style>
        *{
            padding: 0px;
            margin: 0px;
        }
    
    </style>
</head>
<body>
    <div id="MyCalender" style="width:900px;border:1px solid;margin:0 auto;">
       
    </div>

    <button class="" style="float:right;width:100px;height:40px;border:2px solid #62c7a0;border-radius:6px;background-color:skyblue;color:#7a26c3;" onClick="method5(MyCalender)"><i>&gt;&gt;</i>导出</button>
 
</body>
   <script>
        function method5(tableid) {  
            tableToExcel(tableid);   
        }  
        function Cleanup() {  
            window.clearInterval(idTmr);  
            CollectGarbage();  
        }  
        var tableToExcel = (function() {  
            var uri = 'data:application/vnd.ms-excel;base64,',  
                template = '<html><head><meta charset="UTF-8"></head><body><table>{table}</table></body></html>',  
                base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) },  
                format = function(s, c) {  
                    return s.replace(/{(\w+)}/g,  
                    function(m, p) { return c[p]; }) };  
            return function(table, name) {  
                if (!table.nodeType) table = document.getElementById(table);  
                var ctx = {worksheet: name || 'Worksheet', table: table.innerHTML};  
                window.location.href = uri + base64(format(template, ctx));  
            } ; 
        })()
    </script>
</html>