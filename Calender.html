<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>HTMLDemo</title>
    <script src="Calender.js" type="text/javascript"></script>
    <script>
    window.onload = function(){
        ZxCalender.forDiv();
    }
    
    </script>
</head>
<body>
    <div id="MyCalender" >
        <table id="MyCalender">
            <tr>
                <td>
                    <table id="1" style="width:200px;padding:1%">
                        <thead style="width:100%">
                            <tr style="width:100%;" >
                                <td style="width:100%;text-align:center;" colspan="7"><font color="Black">一月</font></td>
                            </tr>
                        </thead>
                        <tbody style="width:100%">
                            <tr id="0" style="width:100%">
                                <td style="width:14%;text-align:center;"><font color="Black" style="background-color: skyblue;">日</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">一</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">二</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">三</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">四</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">五</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">六</font></td>
                            </tr>
                            <tr>
                                <td style="width:14%;text-align:center;" colspan="2"><font color="Black"></font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">1</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">2</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">3</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">4</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">5</font></td>
                            </tr>
                            <tr>
                                <td style="width:14%;text-align:center;"><font color="Black">6</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">7</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">8</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">9</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">10</font></td>
                                <td style="width:14%;text-align:center;" colspan="2"><font color="Black"></font></td>
                            </tr>
                        </tbody>
                    </table>
                </td>
                <td>
                    <table id="1" style="width:200px;padding:1%">
                        <thead style="width:100%">
                            <tr style="width:100%;" >
                                <td style="width:100%;text-align:center;" colspan="7"><font color="Black">一月</font></td>
                            </tr>
                        </thead>
                        <tbody style="width:100%">
                            <tr id="0" style="width:100%">
                                <td style="width:14%;text-align:center;"><font color="Black">日</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">一</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">二</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">三</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">四</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">五</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">六</font></td>
                            </tr>
                            <tr>
                                <td style="width:14%;text-align:center;" colspan="2"><font color="Black"></font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">1</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">2</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">3</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">4</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">5</font></td>
                            </tr>
                            <tr>
                                <td style="width:14%;text-align:center;"><font color="Black">6</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">7</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">8</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">9</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">10</font></td>
                                <td style="width:14%;text-align:center;" colspan="2"><font color="Black"></font></td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
            <tr>
                <td>
                    <table id="1" style="width:200px;padding:1%">
                        <thead style="width:100%">
                            <tr style="width:100%;" >
                                <td style="width:100%;text-align:center;" colspan="7"><font color="Black">一月</font></td>
                            </tr>
                        </thead>
                        <tbody style="width:100%">
                            <tr id="0" style="width:100%;background-color: skyblue;">
                                <td style="width:14%;text-align:center;"><font color="Black">日</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">一</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">二</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">三</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">四</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">五</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">六</font></td>
                            </tr>
                            <tr>
                                <td style="width:14%;text-align:center;background-color: Red;" colspan="2"><font color="Black"></font></td>
                                <td style="width:14%;text-align:center;background-color: Red;"><font color="Green">1</font></td>
                                <td style="width:14%;text-align:center;background-color: Red;"><font color="Green">2</font></td>
                                <td style="width:14%;text-align:center;background-color: Red;"><font color="Green">3</font></td>
                                <td style="width:14%;text-align:center;background-color: Red;"><font color="Green">4</font></td>
                                <td style="width:14%;text-align:center;background-color: Red;"><font color="Green">5</font></td>
                            </tr>
                            <tr>
                                <td style="width:14%;text-align:center;"><font color="Black">6</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">7</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">8</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">9</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">10</font></td>
                                <td style="width:14%;text-align:center;" colspan="2"><font color="Black"></font></td>
                            </tr>
                        </tbody>
                    </table>
                </td>
                <td>
                    <table id="1" style="width:200px;padding:1%">
                        <thead style="width:100%">
                            <tr style="width:100%;" >
                                <td style="width:100%;text-align:center;" colspan="7"><font color="Black">一月</font></td>
                            </tr>
                        </thead>
                        <tbody style="width:100%">
                            <tr id="0" style="width:100%">
                                <td style="width:14%;text-align:center;"><font color="Black">日</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">一</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">二</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">三</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">四</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">五</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">六</font></td>
                            </tr>
                            <tr>
                                <td style="width:14%;text-align:center;" colspan="2"><font color="Black"></font></td>
                                <td style="width:14%;text-align:center;"><font color="Red">1</font></td>
                                <td style="width:14%;text-align:center;"><font color="Red">2</font></td>
                                <td style="width:14%;text-align:center;"><font color="Red">3</font></td>
                                <td style="width:14%;text-align:center;"><font color="Red">4</font></td>
                                <td style="width:14%;text-align:center;"><font color="Red">5</font></td>
                            </tr>
                            <tr>
                                <td style="width:14%;text-align:center;"><font color="Black">6</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">7</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">8</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">9</font></td>
                                <td style="width:14%;text-align:center;"><font color="Black">10</font></td>
                                <td style="width:14%;text-align:center;" colspan="2"><font color="Black"></font></td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
        
        
        </table>
        
    </div>
    <div id="aaa"></div>
    <button class="" onClick="method5(MyCalender)"><i>&#xe644;</i>导出</button>
        <script>
        function method5(tableid) {  
            tableToExcel(tableid);   
        }  
        function Cleanup() {  
            window.clearInterval(idTmr);  
            CollectGarbage();  
        }  
        var tableToExcel = (function() {  
            var uri = 'data:application/vnd.ms-excel;base64,',  
                template = '<html><head><meta charset="UTF-8"></head><body><table>{table}</table></body></html>',  
                base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) },  
                format = function(s, c) {  
                    return s.replace(/{(\w+)}/g,  
                    function(m, p) { return c[p]; }) };  
            return function(table, name) {  
                if (!table.nodeType) table = document.getElementById(table);  
                var ctx = {worksheet: name || 'Worksheet', table: table.innerHTML};  
                window.location.href = uri + base64(format(template, ctx));  
            } ; 
        })()
    
    
    
    </script>

</body>

</html>